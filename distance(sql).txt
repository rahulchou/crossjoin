CREATE TABLE TEST (PIN varchar, LAT int, LONG int);
COPY TEST FROM 'C:\testdata.csv' DELIMITER ',' CSV HEADER;
SELECT * INTO TEST3 FROM TEST;
ALTER TABLE TEST3 RENAME COLUMN PIN to PIN2;
ALTER TABLE TEST3 RENAME COLUMN LAT to LAT2;
ALTER TABLE TEST3 RENAME COLUMN LONG to LONG2; 

CREATE VIEW cross_join AS
SELECT TEST.*, TEST3.* FROM TEST CROSS JOIN TEST3;

SELECT pin,pin2, abs((long2 -long)*(lat2-lat)) AS DIST FROM cross_join


